<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Event</title>
    <link rel="stylesheet" href="/main.css">
</head>
<body>
    <h1>Edit Event</h1>
    <p>Created on: <%= new Date(event.created_at).toLocaleString() %></p>

    <!-- Event Edit Form -->
    <form action="/organiser/events/<%= event.id %>" method="POST" style="margin-bottom:2em;">
        <div>
            <label for="title">Event Title:</label>
            <input type="text" id="title" name="title" value="<%= event.title %>" required>
        </div>
        <div>
            <label for="description">Event Description:</label>
            <textarea id="description" name="description" required><%= event.description %></textarea>
        </div>
        <div>
            <label for="event_date">Event Date:</label>
            <input type="datetime-local" id="event_date" name="event_date" value="<%= new Date(event.event_date).toISOString().slice(0, 16) %>" required>
        </div>
        <button type="submit">Save Changes</button>
    </form>

    <hr>
    <h3>Ticket Types</h3>

    <!-- Add Ticket Type Form -->
    <form action="/organiser/events/<%= event.id %>/tickets/add" method="POST" style="margin-bottom: 1em;">
        <input type="text" name="type_name" placeholder="Type Name (e.g. Full Price)" required>
        <input type="number" name="ticket_count" placeholder="Quantity" min="1" required>
        <input type="number" name="ticket_price" placeholder="Price" min="0" step="0.01" required>
        <button type="submit">Add Ticket Type</button>
    </form>

    <% if (ticketTypes.length === 0) { %>
        <p>No ticket types yet.</p>
    <% } else { %>
        <% ticketTypes.forEach(function(ticket) { %>
            <!-- Edit Ticket Type Form -->
            <form action="/organiser/events/<%= event.id %>/tickets/<%= ticket.id %>/edit" method="POST" style="display:inline-block; margin-right:1em;">
                <input type="text" name="type_name" value="<%= ticket.type_name %>" required>
                <input type="number" name="ticket_count" value="<%= ticket.ticket_count %>" min="1" required>
                <input type="number" name="ticket_price" value="<%= ticket.ticket_price %>" min="0" step="0.01" required>
                <button type="submit">Save</button>
            </form>
            <!-- Delete Ticket Type Form -->
            <form action="/organiser/events/<%= event.id %>/tickets/<%= ticket.id %>/delete" method="POST" style="display:inline-block;">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this ticket type?');">Delete</button>
            </form>
            <br>
        <% }); %>
    <% } %>
    <hr>
    <a href="/organiser">Back to Organiser Home</a>
</body>
</html> 